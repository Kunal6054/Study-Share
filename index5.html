<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StudyShare - Your Academic Hub</title>
    
    <style>
        /* 1. DESIGN SYSTEM & GLOBALS */
        
        :root {
            /* Perplexity Design System colors */
            --color-teal-500: #00a09e;
            --color-cream-50: #fbfbf8;
            --color-cream-100: #ffffff;
            --color-slate-900: #1a202c;

            /* App-specific variables */
            --color-primary: var(--color-teal-500);
            --color-secondary: #805ad5; /* Purple for gradients */
            --color-background: var(--color-cream-50);
            --color-surface: var(--color-cream-100);
            --color-text: var(--color-slate-900);
            --color-text-muted: #4a5568;
            --color-border: #e2e8f0;

            --color-primary-glow: rgba(0, 160, 158, 0.4);
            --color-secondary-glow: rgba(128, 90, 213, 0.4);
            
            --color-success: #38a169;
            --color-error: #e53e3e;
            --color-warning: #dd6b20;

            --font-sans: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --spacing-1: 4px;
            --spacing-2: 8px;
            --spacing-3: 12px;
            --spacing-4: 16px;
            --spacing-5: 20px;
            --spacing-6: 24px;
            --spacing-8: 32px;
            --spacing-10: 40px;
            --spacing-12: 48px;
            
            --border-radius-sm: 4px;
            --border-radius-md: 8px;
            --border-radius-lg: 16px;
            --border-radius-full: 9999px;

            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);

            --transition-ease: cubic-bezier(0.16, 1, 0.3, 1);
            --transition-duration: 0.3s;
        }

        /* Automatic dark mode support */
        @media (prefers-color-scheme: dark) {
            :root {
                --color-background: #121212;
                --color-surface: #1e1e1e;
                --color-text: #f0f0f0;
                --color-text-muted: #a0aec0;
                --color-border: #2d3748;

                --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.2);
                --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.2);
                --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -2px rgba(0, 0, 0, 0.2);
                --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.3), 0 10px 10px -5px rgba(0, 0, 0, 0.2);
            }
        }

        /* CSS Reset */
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--font-sans);
            background-color: var(--color-background);
            color: var(--color-text);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        h1, h2, h3, h4, h5, h6 {
            font-weight: 600;
            line-height: 1.2;
            margin-bottom: var(--spacing-4);
        }

        p {
            margin-bottom: var(--spacing-4);
        }

        a {
            color: var(--color-primary);
            text-decoration: none;
        }

        img, svg, iframe {
            max-width: 100%;
            display: block;
        }

        button, input, select {
            font: inherit;
        }

        /* 2. AUTHENTICATION PAGE (Login/Signup) */

        #auth-page {
            display: flex;
            justify-content: center;
            align-items: flex-start; /* FIX: Align to top by default */
            padding-top: var(--spacing-8); /* Add space at the top on mobile */
            min-height: 100vh;
            width: 100%;
            overflow-x: hidden;
            overflow-y: auto; /* Allow vertical scroll on small devices */
            position: relative;
            background: linear-gradient(135deg, var(--color-background) 0%, #1a1a2e 100%);
            perspective: 2000px;
        }

        /* Re-center for larger screens */
        @media (min-width: 769px) {
            #auth-page {
                align-items: center;
                padding-top: 0; /* Remove top padding */
            }
        }


        @media (prefers-color-scheme: light) {
            #auth-page {
                background: linear-gradient(135deg, #f0f4f8 0%, #d9e2ec 100%);
            }
        }

        /* Particle Background */
        #particle-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            overflow: hidden;
        }

        #particle-bg span {
            position: absolute;
            bottom: -150px;
            background: var(--color-primary);
            border-radius: var(--border-radius-full);
            animation: float 25s linear infinite;
            opacity: 0.2;
        }

        #particle-bg span:nth-child(1) { left: 10%; width: 80px; height: 80px; animation-duration: 22s; }
        #particle-bg span:nth-child(2) { left: 20%; width: 30px; height: 30px; animation-duration: 18s; animation-delay: 2s; background: var(--color-secondary); }
        #particle-bg span:nth-child(3) { left: 30%; width: 50px; height: 50px; animation-duration: 25s; }
        #particle-bg span:nth-child(4) { left: 45%; width: 20px; height: 20px; animation-duration: 15s; animation-delay: 5s; }
        #particle-bg span:nth-child(5) { left: 60%; width: 100px; height: 100px; animation-duration: 20s; background: var(--color-secondary); }
        #particle-bg span:nth-child(6) { left: 75%; width: 40px; height: 40px; animation-duration: 23s; animation-delay: 3s; }
        #particle-bg span:nth-child(7) { left: 85%; width: 60px; height: 60px; animation-duration: 17s; }

        @keyframes float {
            0% { transform: translateY(0) rotate(0deg); }
            100% { transform: translateY(-120vh) rotate(720deg); }
        }

        /* 3D Card */
        .auth-card-flipper {
            position: relative;
            z-index: 2;
            width: 90%;
            max-width: 800px;
            height: 550px;
            transition: transform 0.6s var(--transition-ease);
            transform-style: preserve-3d;
            margin-bottom: var(--spacing-8); /* Add bottom margin on mobile */
        }

        .auth-card-flipper.flipped {
            transform: rotateY(180deg);
        }

        .auth-form-container {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            display: flex;
            border-radius: var(--border-radius-lg);
            overflow: hidden;
            
            /* Glassmorphism */
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            
            /* Neon Glow */
            box-shadow: 0 0 15px var(--color-primary-glow), 
                        0 0 30px var(--color-secondary-glow),
                        inset 0 0 10px rgba(255, 255, 255, 0.05);
        }

        @media (prefers-color-scheme: light) {
            .auth-form-container {
                background: rgba(255, 255, 255, 0.4);
                border: 1px solid rgba(255, 255, 255, 0.5);
                box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
            }
        }

        .login-form {
            z-index: 2;
        }

        .signup-form {
            transform: rotateY(180deg);
        }

        .auth-content, .auth-illustration {
            width: 50%;
            padding: var(--spacing-10);
        }

        .auth-content {
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .auth-illustration {
            display: flex;
            justify-content: center;
            align-items: center;
            background: linear-gradient(135deg, rgba(0, 160, 158, 0.1), rgba(128, 90, 213, 0.1));
            position: relative;
        }

        .auth-illustration svg {
            width: 80%;
            max-width: 300px;
            z-index: 2;
            transform: translateZ(50px); /* 3D effect for illustration */
        }
        
        .auth-illustration .shape {
            position: absolute;
            background: var(--color-primary);
            opacity: 0.3;
            border-radius: 30%;
            animation: morph 8s ease-in-out infinite;
        }
        .auth-illustration .shape.s1 {
            width: 150px; height: 150px; top: 20%; left: 15%; z-index: 1; animation-delay: 0s;
        }
        .auth-illustration .shape.s2 {
            width: 100px; height: 100px; bottom: 20%; right: 15%; z-index: 1; animation-delay: 2s; background: var(--color-secondary);
        }

        @keyframes morph {
            0% { border-radius: 30% 70% 70% 30% / 30% 30% 70% 70%; }
            50% { border-radius: 70% 30% 30% 70% / 70% 70% 30% 30%; }
            100% { border-radius: 30% 70% 70% 30% / 30% 30% 70% 70%; }
        }

        .auth-form-container h1 {
            color: var(--color-text);
            font-size: 2.2rem;
            margin-bottom: var(--spacing-2);
        }

        .auth-form-container p {
            color: var(--color-text-muted);
            margin-bottom: var(--spacing-6);
        }

        .input-group {
            position: relative;
            margin-bottom: var(--spacing-6);
        }

        .input-group input, .input-group select {
            width: 100%;
            padding: var(--spacing-3) var(--spacing-4);
            padding-top: var(--spacing-5);
            background: transparent;
            border: none;
            border-bottom: 2px solid var(--color-border);
            color: var(--color-text);
            font-size: 1rem;
            outline: none;
            transition: border-color 0.3s var(--transition-ease);
        }

        .input-group label {
            position: absolute;
            top: var(--spacing-4);
            left: var(--spacing-4);
            color: var(--color-text-muted);
            pointer-events: none;
            transition: all 0.3s var(--transition-ease);
        }

        .input-group input:focus + label,
        .input-group input:not(:placeholder-shown) + label,
        .input-group select:focus + label,
        .input-group select:not([value=""]) + label {
            top: var(--spacing-1);
            left: var(--spacing-4);
            font-size: 0.75rem;
            color: var(--color-primary);
        }

        .input-group input:focus, .input-group select:focus {
            border-bottom-color: var(--color-primary);
        }
        
        .input-group .error-message {
            color: var(--color-error);
            font-size: 0.8rem;
            margin-top: var(--spacing-1);
            display: none;
            animation: fadeIn 0.3s;
        }

        .input-group.error input, .input-group.error select {
            border-bottom-color: var(--color-error);
        }
        
        .input-group.error .error-message {
            display: block;
        }

        .password-strength {
            display: flex;
            height: 4px;
            margin-top: var(--spacing-1);
        }
        .password-strength-bar {
            flex: 1;
            background: var(--color-border);
            margin-right: 2px;
            transition: background-color 0.3s;
        }
        .password-strength-bar.active.weak { background-color: var(--color-error); }
        .password-strength-bar.active.medium { background-color: var(--color-warning); }
        .password-strength-bar.active.strong { background-color: var(--color-success); }


        .auth-options {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
            margin-bottom: var(--spacing-6);
        }

        .remember-me {
            display: flex;
            align-items: center;
            color: var(--color-text-muted);
        }
        .remember-me input {
            margin-right: var(--spacing-2);
        }

        .forgot-password {
            color: var(--color-primary);
            font-weight: 500;
        }
        
        .btn {
            display: inline-block;
            width: 100%;
            padding: var(--spacing-3) var(--spacing-6);
            border: none;
            border-radius: var(--border-radius-md);
            cursor: pointer;
            font-weight: 600;
            text-align: center;
            transition: all 0.3s var(--transition-ease);
            position: relative;
            overflow: hidden;
            transform: translateZ(0); /* For stacking context */
        }
        
        .btn-primary {
            background: var(--color-primary);
            color: white;
            box-shadow: 0 4px 15px var(--color-primary-glow);
        }

        .btn-primary:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 8px 20px var(--color-primary-glow);
        }

        .btn:active {
            transform: translateY(0) scale(1);
        }
        
        .auth-switch {
            text-align: center;
            margin-top: var(--spacing-6);
            color: var(--color-text-muted);
        }
        .auth-switch-link {
            color: var(--color-primary);
            font-weight: 600;
            cursor: pointer;
        }
        
        /* FIX: Auth Responsive for Mobile Zoom Issue */
        @media (max-width: 768px) {
            .auth-card-flipper {
                width: 95%;
                max-width: 380px; /* Smaller max-width for better fit */
                height: auto; /* Allow content to define height */
                /* Removed margin-top, handled by #auth-page padding */
            }
            .auth-form-container {
                flex-direction: column;
                height: auto;
            }
            .auth-content, .auth-illustration {
                width: 100%;
            }
            .auth-illustration {
                height: 150px; /* Reduced height */
                padding: var(--spacing-4);
            }
            .auth-illustration svg {
                width: 50%;
            }
            .auth-content {
                padding: var(--spacing-6); /* Reduced vertical padding */
            }
            .auth-form-container h1 {
                font-size: 1.6rem; /* Reduced font size */
            }
            .auth-form-container p {
                margin-bottom: var(--spacing-4); /* Less margin */
            }
            .input-group {
                margin-bottom: var(--spacing-4);
            }
        }

        /* 3. MAIN APPLICATION */

        #app-page {
            display: none; /* Hidden by default */
            padding-bottom: 80px; /* Space for mobile nav */
        }

        /* Header */
        .app-header {
            position: sticky;
            top: 0;
            z-index: 1000;
            padding: var(--spacing-4) var(--spacing-6);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--color-border);
        }
        
        @media (prefers-color-scheme: dark) {
            .app-header {
                background: rgba(30, 30, 30, 0.7);
            }
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--color-primary);
        }
        .logo span {
            color: var(--color-text);
        }

        .header-nav {
            display: flex;
            align-items: center;
            gap: var(--spacing-5);
        }

        .profile-btn {
            width: 40px;
            height: 40px;
            border-radius: var(--border-radius-full);
            background: var(--color-primary);
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: 600;
            cursor: pointer;
            border: none;
        }

        .btn-logout {
            padding: var(--spacing-2) var(--spacing-4);
            background: var(--color-error);
            color: white;
            border: none;
            border-radius: var(--border-radius-md);
            cursor: pointer;
            font-size: 0.9rem;
            transition: background-color 0.3s;
        }
        .btn-logout:hover {
            background: #c53030;
        }
        
        .desktop-nav {
            display: flex;
            gap: var(--spacing-5);
        }
        .desktop-nav .nav-link {
            font-weight: 500;
            color: var(--color-text-muted);
            cursor: pointer;
            transition: color 0.3s;
        }
        .desktop-nav .nav-link:hover,
        .desktop-nav .nav-link.active {
            color: var(--color-primary);
        }
        
        @media (max-width: 768px) {
            .desktop-nav {
                display: none;
            }
        }


        /* Page Sections */
        .app-section {
            padding: var(--spacing-8) var(--spacing-6);
            max-width: 1200px;
            margin: 0 auto;
            min-height: 80vh;
        }

        .page-title {
            font-size: 2rem;
            margin-bottom: var(--spacing-6);
        }

        /* 4. DASHBOARD PAGE (Branch Selection) */

        .branch-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--spacing-6);
        }

        .branch-card {
            background: var(--color-surface);
            border-radius: var(--border-radius-lg);
            padding: var(--spacing-6);
            text-align: center;
            border: 1px solid var(--color-border);
            box-shadow: var(--shadow-md);
            cursor: pointer;
            transition: transform 0.3s var(--transition-ease), box-shadow 0.3s var(--transition-ease);
            transform-style: preserve-3d;
        }

        /* 3D Tilt Effect - Desktop Only (hover: hover) */
        @media (hover: hover) and (min-width: 1024px) {
            .branch-card:hover {
                box-shadow: var(--shadow-xl);
            }
        }
        
        /* Simpler hover/active for mobile */
        @media (hover: none) {
            .branch-card:active {
                transform: scale(0.98);
                box-shadow: var(--shadow-sm);
            }
        }

        .branch-card .icon-container {
            width: 80px;
            height: 80px;
            margin: 0 auto var(--spacing-4);
            border-radius: var(--border-radius-full);
            display: flex;
            justify-content: center;
            align-items: center;
            background: var(--color-primary-glow);
            transition: background-color 0.3s var(--transition-ease);
        }
        .branch-card .icon-container svg {
            width: 40px;
            height: 40px;
            stroke: var(--color-primary);
        }
        .branch-card h3 {
            font-size: 1.25rem;
            color: var(--color-text);
            margin-bottom: var(--spacing-2);
        }
        .branch-card p {
            font-size: 0.9rem;
            color: var(--color-text-muted);
            margin-bottom: 0;
        }

        .branch-card:hover .icon-container {
            background: var(--color-primary);
        }
        .branch-card:hover .icon-container svg {
            stroke: white;
        }

        /* Color-coded themes */
        .branch-card[data-branch="CSE"] { --color-primary: #00a09e; --color-primary-glow: rgba(0, 160, 158, 0.2); }
        .branch-card[data-branch="IT"] { --color-primary: #3182ce; --color-primary-glow: rgba(49, 130, 206, 0.2); }
        .branch-card[data-branch="ECE"] { --color-primary: #dd6b20; --color-primary-glow: rgba(221, 107, 32, 0.2); }
        .branch-card[data-branch="EE"] { --color-primary: #d69e2e; --color-primary-glow: rgba(214, 158, 46, 0.2); }
        .branch-card[data-branch="ME"] { --color-primary: #6b7280; --color-primary-glow: rgba(107, 114, 128, 0.2); }
        .branch-card[data-branch="CE"] { --color-primary: #38a169; --color-primary-glow: rgba(56, 161, 105, 0.2); }
        

        /* 5. SEMESTER PAGE */

        .breadcrumb {
            font-size: 0.9rem;
            color: var(--color-text-muted);
            margin-bottom: var(--spacing-6);
        }
        .breadcrumb .nav-link {
            color: var(--color-primary);
            cursor: pointer;
        }

        .semester-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--spacing-5);
        }

        .semester-card {
            background: var(--color-surface);
            border-radius: var(--border-radius-md);
            padding: var(--spacing-5);
            border: 1px solid var(--color-border);
            box-shadow: var(--shadow-sm);
            cursor: pointer;
            transition: transform 0.3s var(--transition-ease), box-shadow 0.3s var(--transition-ease);
            animation: fadeIn 0.5s var(--transition-ease) forwards;
            opacity: 0;
        }
        
        .semester-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        
        .semester-card:active {
            transform: translateY(0) scale(0.98);
            box-shadow: var(--shadow-sm);
        }
        
        .semester-card h3 {
            font-size: 1.1rem;
            margin-bottom: var(--spacing-2);
        }
        .semester-card p {
            font-size: 0.9rem;
            color: var(--color-text-muted);
            margin-bottom: 0;
        }

        /* 6. QUESTION PAPERS PAGE */

        .paper-filters {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            gap: var(--spacing-4);
            margin-bottom: var(--spacing-6);
        }
        
        .filter-group {
            position: relative;
        }
        .filter-group .icon {
            position: absolute;
            top: 50%;
            left: var(--spacing-3);
            transform: translateY(-50%);
            width: 18px;
            height: 18px;
            stroke: var(--color-text-muted);
        }
        
        .filter-input, .filter-select {
            width: 100%;
            padding: var(--spacing-3) var(--spacing-4);
            background: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius-md);
            color: var(--color-text);
        }
        
        .filter-input {
            padding-left: var(--spacing-8);
        }
        
        .paper-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: var(--spacing-5);
        }

        .paper-card {
            background: var(--color-surface);
            border-radius: var(--border-radius-md);
            border: 1px solid var(--color-border);
            box-shadow: var(--shadow-sm);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transition: box-shadow 0.3s var(--transition-ease);
            animation: fadeIn 0.5s var(--transition-ease) forwards;
            opacity: 0;
        }
        
        .paper-card:hover {
            box-shadow: var(--shadow-lg);
        }
        
        .paper-card-header {
            padding: var(--spacing-4);
            border-bottom: 1px solid var(--color-border);
        }
        .paper-card-header .subject-name {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: var(--spacing-2);
        }
        .paper-card-header .type-badge {
            display: inline-block;
            padding: var(--spacing-1) var(--spacing-2);
            font-size: 0.75rem;
            font-weight: 500;
            border-radius: var(--border-radius-full);
            color: white;
        }
        
        .badge-end-term { background-color: var(--color-primary); }
        .badge-mid-term { background-color: var(--color-secondary); }
        .badge-important-questions { background-color: var(--color-warning); }
        .badge-pyq { background-color: #3182ce; } 
        .badge-notes { background-color: #6b7280; } 

        .paper-card-body {
            padding: var(--spacing-4);
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
            color: var(--color-text-muted);
            flex-grow: 1;
        }
        
        .paper-card-body .info-item {
            display: flex;
            align-items: center;
            gap: var(--spacing-2);
        }
        .paper-card-body .info-item svg {
            width: 16px;
            height: 16px;
            stroke: var(--color-text-muted);
        }

        /* START MODIFICATION: Status badge for profile page */
        .paper-card-body .status-badge {
            font-size: 0.8rem;
            font-weight: 600;
            padding: var(--spacing-1) var(--spacing-2);
            border-radius: var(--border-radius-full);
        }
        .status-badge.pending {
            color: var(--color-warning);
            background: rgba(221, 107, 32, 0.1);
        }
        .status-badge.approved {
            color: var(--color-success);
            background: rgba(56, 161, 105, 0.1);
        }
        /* END MODIFICATION */
        
        .paper-card-footer {
            padding: var(--spacing-4);
            border-top: 1px solid var(--color-border);
            display: flex;
            gap: var(--spacing-3);
        }
        
        .btn-sm {
            flex: 1;
            padding: var(--spacing-2) var(--spacing-4);
            font-size: 0.9rem;
            position: relative; /* For ripple */
        }
        
        .btn-outline {
            background: transparent;
            border: 1px solid var(--color-primary);
            color: var(--color-primary);
            box-shadow: none;
        }
        .btn-outline:hover {
            background: var(--color-primary-glow);
            transform: none;
            box-shadow: none;
        }
        
        /* Ripple effect */
        .ripple {
            position: absolute;
            border-radius: 50%;
            transform: scale(0);
            animation: ripple-anim 0.6s linear;
            background-color: rgba(255, 255, 255, 0.7);
        }

        @keyframes ripple-anim {
            to {
                transform: scale(4);
                opacity: 0;
            }
        }
        
        .empty-state {
            text-align: center;
            padding: var(--spacing-10);
            background: var(--color-surface);
            border-radius: var(--border-radius-md);
            border: 1px dashed var(--color-border);
            grid-column: 1 / -1; /* Span full grid */
        }
        .empty-state svg {
            width: 60px;
            height: 60px;
            margin: 0 auto var(--spacing-4);
            stroke: var(--color-text-muted);
        }
        .empty-state h3 {
            font-size: 1.2rem;
        }
        .empty-state p {
            color: var(--color-text-muted);
            margin-bottom: 0;
        }

        /* 7. UPLOAD PAGE */
        
        /* FIX: Style select dropdowns to respect dark mode */
        .upload-form .input-group select {
            background-color: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius-md);
        }
        
        .upload-form .input-group select:focus {
            border-color: var(--color-primary);
            box-shadow: 0 0 0 3px var(--color-primary-glow);
            outline: none;
        }

        .upload-form {
            max-width: 700px;
            margin: 0 auto;
            background: var(--color-surface);
            padding: var(--spacing-8);
            border-radius: var(--border-radius-lg);
            border: 1px solid var(--color-border);
            box-shadow: var(--shadow-lg);
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--spacing-5);
            margin-bottom: var(--spacing-6);
        }
        
        .form-grid .full-width {
            grid-column: 1 / -1;
        }
        
        .upload-form .input-group {
            margin-bottom: 0;
        }
        
        /* Re-styling select for floating label */
        .input-group select {
            padding: var(--spacing-3) var(--spacing-4);
            padding-top: var(--spacing-5);
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='none' stroke='%234a5568' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' class='icon icon-tabler icon-tabler-chevron-down'%3E%3Cpath d='m6 9 6 6 6-6'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right var(--spacing-4) center;
            background-size: 16px;
        }
        
        @media (prefers-color-scheme: dark) {
            .input-group select {
                 background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='none' stroke='%23a0aec0' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' class='icon icon-tabler icon-tabler-chevron-down'%3E%3Cpath d='m6 9 6 6 6-6'/%3E%3C/svg%3E");
            }
            .input-group select:focus {
                 background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='none' stroke='%2300a09e' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' class='icon icon-tabler icon-tabler-chevron-down'%3E%3Cpath d='m6 9 6 6 6-6'/%3E%3C/svg%3E");
            }
        }
        
        .drop-zone {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: var(--spacing-8);
            border: 2px dashed var(--color-border);
            border-radius: var(--border-radius-md);
            text-align: center;
            color: var(--color-text-muted);
            cursor: pointer;
            transition: all 0.3s var(--transition-ease);
        }
        .drop-zone svg {
            width: 48px;
            height: 48px;
            stroke: var(--color-text-muted);
            margin-bottom: var(--spacing-4);
            transition: all 0.3s var(--transition-ease);
        }
        .drop-zone.dragging {
            border-color: var(--color-primary);
            background: var(--color-primary-glow);
            box-shadow: 0 0 15px var(--color-primary-glow);
            transform: scale(1.02);
        }
        .drop-zone.dragging svg {
            stroke: var(--color-primary);
            transform: scale(1.1);
        }
        #file-upload-input {
            display: none;
        }
        
        #file-preview {
            margin-top: var(--spacing-4);
            font-size: 0.9rem;
            display: none;
            animation: fadeIn 0.3s;
        }
        
        #file-preview p {
            margin-bottom: var(--spacing-2);
        }

        .progress-bar-container {
            width: 100%;
            height: 8px;
            background: var(--color-border);
            border-radius: var(--border-radius-full);
            overflow: hidden;
            margin-top: var(--spacing-2);
        }
        .progress-bar {
            width: 0%;
            height: 100%;
            background: var(--color-primary);
            border-radius: var(--border-radius-full);
            transition: width 0.5s var(--transition-ease);
        }

        /* 8. PROFILE PAGE */
        .profile-header {
            display: flex;
            align-items: center;
            gap: var(--spacing-6);
            margin-bottom: var(--spacing-8);
            background: var(--color-surface);
            padding: var(--spacing-6);
            border-radius: var(--border-radius-lg);
            border: 1px solid var(--color-border);
        }
        .profile-avatar {
            width: 80px;
            height: 80px;
            border-radius: var(--border-radius-full);
            background: var(--color-primary);
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2.5rem;
            font-weight: 600;
        }
        .profile-info h2 {
            margin-bottom: var(--spacing-1);
        }
        .profile-info p {
            color: var(--color-text-muted);
            margin-bottom: 0;
        }
        
        #my-uploads-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: var(--spacing-5);
        }


        /* 9. MODAL (PDF PREVIEW) */
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s var(--transition-ease), visibility 0s 0.3s;
        }
        .modal.open {
            opacity: 1;
            visibility: visible;
            transition: opacity 0.3s var(--transition-ease);
        }
        
        .modal-content {
            background: var(--color-surface);
            width: 90%;
            height: 90%;
            max-width: 900px;
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-xl);
            display: flex;
            flex-direction: column;
            transform: scale(0.9);
            transition: transform 0.3s var(--transition-ease);
        }
        .modal.open .modal-content {
            transform: scale(1);
        }
        
        .modal-header {
            padding: var(--spacing-4);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--color-border);
        }
        .modal-header h3 {
            margin-bottom: 0;
            font-size: 1.1rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .modal-close-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: var(--spacing-2);
        }
        .modal-close-btn svg {
            width: 24px;
            height: 24px;
            stroke: var(--color-text-muted);
        }
        
        .modal-body {
            flex-grow: 1;
            padding: 0; /* Remove padding for iframe */
            overflow: hidden; /* Hide overflow */
        }
        
        /* Real iframe for preview */
        #pdf-iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        /* Simulation placeholder */
        #pdf-simulation {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100%;
            color: var(--color-text-muted);
            text-align: center;
            padding: var(--spacing-4);
        }
        #pdf-simulation svg {
            width: 100px; height: 100px; stroke: var(--color-primary); margin-bottom: var(--spacing-6);
        }
        #pdf-simulation h4 { color: var(--color-text); }

        .modal-footer {
            padding: var(--spacing-4);
            border-top: 1px solid var(--color-border);
            text-align: right;
        }

        /* 10. NOTIFICATIONS */
        
        #notification-container {
            position: fixed;
            top: var(--spacing-12);
            right: var(--spacing-6);
            z-index: 3000;
            display: flex;
            flex-direction: column;
            gap: var(--spacing-3);
        }
        
        .notification {
            min-width: 250px;
            padding: var(--spacing-4);
            background: var(--color-surface);
            border-radius: var(--border-radius-md);
            box-shadow: var(--shadow-lg);
            border-left: 4px solid var(--color-primary);
            animation: slideInRight 0.5s var(--transition-ease) forwards;
        }
        
        .notification.success { border-color: var(--color-success); }
        .notification.error { border-color: var(--color-error); }
        .notification.info { border-color: #3182ce; }
        .notification.removing { animation: slideOutRight 0.5s var(--transition-ease) forwards; }
        
        .notification p {
            margin: 0;
            font-weight: 500;
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100%);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes slideOutRight {
            from {
                opacity: 1;
                transform: translateX(0);
            }
            to {
                opacity: 0;
                transform: translateX(100%);
            }
        }
        
        /* 11. MOBILE NAVIGATION */

        .mobile-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 65px;
            background: var(--color-surface);
            border-top: 1px solid var(--color-border);
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.05);
            display: none; /* Hidden by default */
            justify-content: space-around;
            align-items: center;
            z-index: 1500;
        }
        
        @media (prefers-color-scheme: dark) {
            .mobile-nav {
                box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.2);
            }
        }

        .mobile-nav-link {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: var(--color-text-muted);
            font-size: 0.75rem;
            cursor: pointer;
            padding: var(--spacing-2);
            transition: color 0.3s;
        }
        
        .mobile-nav-link svg {
            width: 24px;
            height: 24px;
            stroke: var(--color-text-muted);
            margin-bottom: var(--spacing-1);
            transition: all 0.3s;
        }
        
        .mobile-nav-link.active {
            color: var(--color-primary);
        }
        .mobile-nav-link.active svg {
            stroke: var(--color-primary);
            transform: scale(1.1);
        }

        @media (max-width: 768px) {
            .mobile-nav {
                display: flex;
            }
            .app-header {
                padding-left: var(--spacing-4);
                padding-right: var(--spacing-4);
            }
            .app-section {
                padding: var(--spacing-6) var(--spacing-4);
            }
            
            /* Responsive Filters */
            .paper-filters {
                grid-template-columns: 1fr;
            }
            .paper-filters .filter-group {
                margin-bottom: var(--spacing-3);
            }
            
            /* Responsive Upload Form */
            .upload-form {
                padding: var(--spacing-6);
            }
            .form-grid {
                grid-template-columns: 1fr;
            }
            .form-grid .full-width {
                grid-column: 1 / 1;
            }
            
            .profile-header {
                flex-direction: column;
                align-items: center;
                text-align: center;
            }
        }

        /* 12. ANIMATIONS & HELPERS */

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Stagger animation */
        .stagger-container .stagger-child {
            animation: fadeIn 0.5s var(--transition-ease) forwards;
            opacity: 0;
        }
    </style>
</head>
<body>

    <svg width="0" height="0" style="display:none;">
        <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-code">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <polyline points="7 8 3 12 7 16" />
            <polyline points="17 8 21 12 17 16" />
            <line x1="14" y1="4" x2="10" y2="20" />
        </symbol>
        <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-chip">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <rect x="4" y="4" width="16" height="16" rx="2" />
            <line x1="9" y1="4" x2="9" y2="20" />
            <line x1="15" y1="4" x2="15" y2="20" />
            <line x1="4" y1="9" x2="20" y2="9" />
            <line x1="4" y1="15" x2="20" y2="15" />
        </symbol>
        <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-gear">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z" />
            <circle cx="12" cy="12" r="3" />
        </symbol>
        <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-helmet">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M12 4a9 9 0 0 1 6.326 15.342a9 9 0 0 1 -12.652 0a9 9 0 0 1 6.326 -15.342" />
            <path d="M12 13h.01" />
            <path d="M19 14a3 3 0 0 0 -3 -3h-8a3 3 0 0 0 -3 3" />
        </symbol>
        <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-bolt">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <polyline points="13 3 13 10 19 10 11 21 11 14 5 14 13 3" />
        </symbol>
        <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-screen">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <rect x="3" y="4" width="18" height="12" rx="1" />
            <line x1="7" y1="20" x2="17" y2="20" />
            <line x1="12" y1="16" x2="12" y2="20" />
        </symbol>
        <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-home">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <polyline points="5 12 3 12 12 3 21 12 19 12" />
            <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
            <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
        </symbol>
        <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-upload">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2" />
            <polyline points="7 9 12 4 17 9" />
            <line x1="12" y1="4" x2="12" y2="16" />
        </symbol>
        <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-user">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <circle cx="12" cy="7" r="4" />
            <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
        </symbol>
        <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-search">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <circle cx="10" cy="10" r="7" />
            <line x1="21" y1="21" x2="15" y2="15" />
        </symbol>
        <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-calendar">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <rect x="4" y="5" width="16" height="16" rx="2" />
            <line x1="16" y1="3" x2="16" y2="7" />
            <line x1="8" y1="3" x2="8" y2="7" />
            <line x1="4" y1="11" x2="20" y2="11" />
        </symbol>
        <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-download">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2" />
            <polyline points="7 11 12 16 17 11" />
            <line x1="12" y1="4" x2="12" y2="16" />
        </symbol>
        <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-file">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M14 3v4a1 1 0 0 0 1 1h4" />
            <path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z" />
        </symbol>
        <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-eye">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <circle cx="12" cy="12" r="2" />
            <path d="M22 12c-2.667 4.667 -6 7 -10 7s-7.333 -2.333 -10 -7c2.667 -4.667 6 -7 10 -7s7.333 2.333 10 7" />
        </symbol>
        <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-x">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <line x1="18" y1="6" x2="6" y2="18" />
            <line x1="6" y1="6" x2="18" y2="18" />
        </symbol>
        <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-box">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <polyline points="12 3 20 7.5 20 16.5 12 21 4 16.5 4 7.5 12 3" />
            <line x1="12" y1="12" x2="20" y2="7.5" />
            <line x1="12" y1="12" x2="4" y2="7.5" />
            <line x1="12" y1="12" x2="12" y2="21" />
        </symbol>
        <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-file-upload">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M14 3v4a1 1 0 0 0 1 1h4" />
            <path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z" />
            <line x1="12" y1="11" x2="12" y2="17" />
            <polyline points="9 14 12 11 15 14" />
        </symbol>
        <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-clock">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <circle cx="12" cy="12" r="9" />
            <polyline points="12 7 12 12 15 15" />
        </symbol>
        </svg>

    <section id="auth-page">
        <div id="particle-bg">
            <span></span><span></span><span></span><span></span><span></span><span></span><span></span>
        </div>

        <div class="auth-card-flipper" id="auth-card-flipper">
            
            <div class="auth-form-container login-form">
                <div class="auth-illustration">
                    <span class="shape s1"></span>
                    <span class="shape s2"></span>
                    <svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
                        <g fill="none" stroke-width="5" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M100 70a20 20 0 1 0 0-40 20 20 0 0 0 0 40z" fill="var(--color-primary-glow)" stroke="var(--color-primary)"/>
                            <path d="M70 100c0 22 13.4 40 30 40s30-18 30-40v-20H70v20z" fill="var(--color-secondary-glow)" stroke="var(--color-secondary)"/>
                            <path d="M70 80h60M100 140v30M80 170h40" stroke="var(--color-text-muted)"/>
                            <path d="M60 170l-10-70h100l-10 70H60z" fill="var(--color-primary-glow)" stroke="var(--color-primary)"/>
                        </g>
                    </svg>
                </div>
                <div class="auth-content">
                    <h1>Welcome Back!</h1>
                    <p>Login to access your study materials.</p>
                    <form id="login-form" novalidate>
                        <div class="input-group">
                            <input type="email" id="login-email" placeholder=" " required>
                            <label for="login-email">Email Address</label>
                            <div class="error-message">Please enter a valid email.</div>
                        </div>
                        <div class="input-group">
                            <input type="password" id="login-password" placeholder=" " required minlength="8">
                            <label for="login-password">Password</label>
                            <div class="error-message">Password must be at least 8 characters.</div>
                        </div>
                        <div class="auth-options">
                            <label class="remember-me">
                                <input type="checkbox" id="remember-me"> Remember Me
                            </label>
                            <a href="#" class="forgot-password">Forgot Password?</a>
                        </div>
                        <button type="submit" class="btn btn-primary">Login</button>
                    </form>
                    <div class="auth-switch">
                        Don't have an account? <span class="auth-switch-link" id="show-signup-btn">Sign Up</span>
                    </div>
                </div>
            </div>

            <div class="auth-form-container signup-form">
                <div class="auth-content">
                    <h1>Create Account</h1>
                    <p>Join our community to start sharing.</p>
                    <form id="signup-form" novalidate>
                        <div class="input-group">
                            <input type="text" id="signup-name" placeholder=" " required>
                            <label for="signup-name">Full Name</label>
                            <div class="error-message">Name is required.</div>
                        </div>
                        <div class="input-group">
                            <input type="email" id="signup-email" placeholder=" " required>
                            <label for="signup-email">Email Address</label>
                            <div class="error-message">Please enter a valid email.</div>
                        </div>
                        <div class="input-group">
                            <input type="password" id="signup-password" placeholder=" " required minlength="8">
                            <label for="signup-password">Password</label>
                            <div class="password-strength">
                                <div class="password-strength-bar"></div>
                                <div class="password-strength-bar"></div>
                                <div class="password-strength-bar"></div>
                            </div>
                            <div class="error-message">Password must be at least 8 characters.</div>
                        </div>
                        <button type="submit" class="btn btn-primary">Create Account</button>
                    </form>
                    <div class="auth-switch">
                        Already have an account? <span class="auth-switch-link" id="show-login-btn">Log In</span>
                    </div>
                </div>
                <div class="auth-illustration">
                    <span class="shape s1"></span>
                    <span class="shape s2"></span>
                    <svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
                        <g fill="none" stroke-width="5" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M60 30h80v140H60z" fill="var(--color-primary-glow)" stroke="var(--color-primary)"/>
                            <path d="M70 50h60M70 70h60M70 90h30" stroke="var(--color-primary)"/>
                            <path d="M110 140l-20 20-20-20m20-40v60" stroke="var(--color-secondary)" stroke-width="6"/>
                        </g>
                    </svg>
                </div>
            </div>

        </div>
    </section>

    <main id="app-page">

        <header class="app-header">
            <div class="logo">Study<span>Share</span></div>
            <nav class="desktop-nav">
                <span class="nav-link active" data-page="dashboard-page">Home</span>
                <span class="nav-link" data-page="upload-page">Upload</span>
            </nav>
            <div class="header-nav">
                <button class="profile-btn" data-page="profile-page">S</button>
                <button class="btn-logout" id="logout-btn">Logout</button>
            </div>
        </header>

        <div id="app-content-area">

            <section class="app-section" id="dashboard-page">
                <h1 class="page-title">Select Your Branch</h1>
                <div class="branch-grid">
                    <div class="branch-card" data-branch="CSE">
                        <div class="icon-container"><svg fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><use href="#icon-code"></use></svg></div>
                        <h3>Computer Science (CSE)</h3>
                        <p>Algorithms, Data Structures, AI, ML...</p>
                    </div>
                    <div class="branch-card" data-branch="IT">
                        <div class="icon-container"><svg fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><use href="#icon-screen"></use></svg></div>
                        <h3>Information Technology (IT)</h3>
                        <p>Networking, Web Dev, Cybersecurity...</p>
                    </div>
                    <div class="branch-card" data-branch="ECE">
                        <div class="icon-container"><svg fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><use href="#icon-chip"></use></svg></div>
                        <h3>Electronics (ECE)</h3>
                        <p>Circuits, VLSI, Communication...</p>
                    </div>
                    <div class="branch-card" data-branch="EE">
                        <div class="icon-container"><svg fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><use href="#icon-bolt"></use></svg></div>
                        <h3>Electrical (EE)</h3>
                        <p>Power Systems, Machines, Control...</p>
                    </div>
                    <div class="branch-card" data-branch="ME">
                        <div class="icon-container"><svg fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><use href="#icon-gear"></use></svg></div>
                        <h3>Mechanical (ME)</h3>
                        <p>Thermodynamics, Fluid Mechanics...</p>
                    </div>
                    <div class="branch-card" data-branch="CE">
                        <div class="icon-container"><svg fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><use href="#icon-helmet"></use></svg></div>
                        <h3>Civil (CE)</h3>
                        <p>Structures, Surveying, Geotech...</p>
                    </div>
                </div>
            </section>

            <section class="app-section" id="semester-page" style="display: none;">
                <div class="breadcrumb" id="semester-breadcrumb">
                    <span class="nav-link" data-page="dashboard-page">Home</span> &gt; CSE
                </div>
                <h1 class="page-title" id="semester-page-title">Select Semester</h1>
                <div class="semester-grid stagger-container" id="semester-grid">
                    </div>
            </section>

            <section class="app-section" id="papers-page" style="display: none;">
                <div class="breadcrumb" id="papers-breadcrumb">
                    <span class="nav-link" data-page="dashboard-page">Home</span> &gt; <span class="nav-link" id="breadcrumb-branch" data-page="semester-page">CSE</span> &gt; Semester 3
                </div>
                <h1 class="page-title" id="papers-page-title">Question Papers</h1>
                
                <div class="paper-filters">
                    <div class="filter-group">
                        <svg class="icon" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><use href="#icon-search"></use></svg>
                        <input type="search" id="paper-search" class="filter-input" placeholder="Search by subject name...">
                    </div>
                    <select id="filter-year" class="filter-select">
                        <option value="all">All Years</option>
                        <option value="2025">2025</option>
                        <option value="2024">2024</option>
                        <option value="2023">2023</option>
                        <option value="2022">2022</option>
                        <option value="2021">2021</option>
                        <option value="2020">2020</option>
                    </select>
                    <select id="filter-type" class="filter-select">
                        <option value="all">All Types</option>
                        <option value="End-term">End-term</option>
                        <option value="Mid-term">Mid-term</option>
                        <option value="Important Questions">Important Questions</option>
                        <option value="PYQ">PYQ</option>
                        <option value="Notes">Notes</option>
                    </select>
                    <select id="sort-by" class="filter-select">
                        <option value="newest">Sort by Newest</option>
                        <option value="downloads">Sort by Most Downloaded</option>
                    </select>
                </div>

                <div class="paper-list stagger-container" id="paper-list">
                    </div>
                
                <div class="empty-state" id="empty-state" style="display: none;">
                    <svg fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><use href="#icon-box"></use></svg>
                    <h3>No Papers Found</h3>
                    <p>Try adjusting your filters or be the first to upload one!</p>
                </div>
            </section>

            <section class="app-section" id="upload-page" style="display: none;">
                <h1 class="page-title">Upload Material</h1>
                <form class="upload-form" id="upload-form">
                    <div class="form-grid">
                        <div class="input-group full-width">
                            <input type="text" id="upload-subject" placeholder=" " required>
                            <label for="upload-subject">Subject Name</label>
                            <div class="error-message">Subject is required.</div>
                        </div>
                        
                        <div class="input-group">
                            <select id="upload-course" required>
                                <option value="" disabled selected></option>
                                <option value="Btech">B.Tech</option>
                                <option value="MCA">MCA</option>
                                <option value="MBA">MBA</option>
                            </select>
                            <label for="upload-course">Course</label>
                            <div class="error-message">Please select a course.</div>
                        </div>
                        
                        <div class="input-group">
                            <select id="upload-branch" required>
                                <option value="" disabled selected></option>
                                <option value="CSE">Computer Science (CSE)</option>
                                <option value="IT">Information Technology (IT)</option>
                                <option value="ECE">Electronics (ECE)</option>
                                <option value="EE">Electrical (EE)</option>
                                <option value="ME">Mechanical (ME)</option>
                                <option value="CE">Civil (CE)</option>
                            </select>
                            <label for="upload-branch">Branch</label>
                            <div class="error-message">Please select a branch.</div>
                        </div>
                        <div class="input-group">
                            <select id="upload-semester" required>
                                <option value="" disabled selected></option>
                                <option value="1">Semester 1</option>
                                <option value="2">Semester 2</option>
                                <option value="3">Semester 3</option>
                                <option value="4">Semester 4</option>
                                <option value="5">Semester 5</option>
                                <option value="6">Semester 6</option>
                                <option value="7">Semester 7</option>
                                <option value="8">Semester 8</option>
                            </select>
                            <label for="upload-semester">Semester</label>
                            <div class="error-message">Please select a semester.</div>
                        </div>
                        <div class="input-group">
                            <select id="upload-year" required>
                                <option value="" disabled selected></option>
                                <option value="2025">2025</option>
                                <option value="2024">2024</option>
                                <option value="2023">2023</option>
                                <option value="2022">2022</option>
                                <option value="2021">2021</option>
                                <option value="2020">2020</option>
                            </select>
                            <label for="upload-year">Year</label>
                            <div class="error-message">Please select a year.</div>
                        </div>
                        <div class="input-group">
                            <select id="upload-type" required>
                                <option value="" disabled selected></option>
                                <option value="End-term">End-term</option>
                                <option value="Mid-term">Mid-term</option>
                                <option value="Important Questions">Important Questions</option>
                                <option value="PYQ">PYQ</option>
                                <option value="Notes">Notes</option>
                            </select>
                            <label for="upload-type">Paper Type</label>
                            <div class="error-message">Please select a type.</div>
                        </div>
                    </div>
                    
                    <div class="input-group full-width">
                        <div class="drop-zone" id="drop-zone">
                            <input type="file" id="file-upload-input" accept="application/pdf" hidden>
                            <svg fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><use href="#icon-file-upload"></use></svg>
                            <p><b>Drag & drop a PDF file here</b></p>
                            <p>or click to select file (Max 10MB)</p>
                        </div>
                        <div id="file-preview">
                            <p><b>Selected File:</b> <span id="file-name"></span> (<span id="file-size"></span>)</p>
                            <div class="progress-bar-container">
                                <div class="progress-bar" id="upload-progress"></div>
                            </div>
                        </div>
                        <div class="error-message" id="file-error"></div>
                    </div>
                    
                    <button type="submit" class="btn btn-primary" style="margin-top: var(--spacing-6);">Upload Paper</button>
                </form>
            </section>
            
            <section class="app-section" id="profile-page" style="display: none;">
                <div class="profile-header">
                    <div class="profile-avatar" id="profile-avatar-initial">S</div>
                    <div class="profile-info">
                        <h1 id="profile-name" style="margin-bottom: 0;">Student</h1>
                        <p id="profile-email">student@example.com</p>
                    </div>
                </div>
                
                <h2 style="font-size: 1.5rem; margin-bottom: var(--spacing-5);">My Uploads</h2>
                
                <div class="paper-list stagger-container" id="my-uploads-list">
                    </div>
                
                <div class="empty-state" id="my-uploads-empty-state" style="display: none;">
                    <svg fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><use href="#icon-box"></use></svg>
                    <h3>No Uploads Yet</h3>
                    <p>You haven't uploaded any papers. Click the "Upload" tab to share!</p>
                </div>
            </section>
            
        </div>

        <nav class="mobile-nav" id="mobile-nav">
            <div class="mobile-nav-link active" data-page="dashboard-page">
                <svg fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><use href="#icon-home"></use></svg>
                <span>Home</span>
            </div>
            <div class="mobile-nav-link" data-page="upload-page">
                <svg fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><use href="#icon-upload"></use></svg>
                <span>Upload</span>
            </div>
            <div class="mobile-nav-link" data-page="profile-page">
                <svg fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><use href="#icon-user"></use></svg>
                <span>Profile</span>
            </div>
        </nav>
    </main>

    <div class="modal" id="pdf-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title"></h3>
                <button class="modal-close-btn" id="modal-close-btn">
                    <svg fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><use href="#icon-x"></use></svg>
                </button>
            </div>
            <div class="modal-body">
                <iframe id="pdf-iframe" src="" frameborder="0"></iframe>
                
                <div id="pdf-simulation">
                    <svg fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><use href="#icon-file"></use></svg>
                    <h4>PDF Preview Simulation</h4>
                    <p>This is a sample paper. A real preview would be shown for your own uploads.</p>
                    <p>File: <b id="modal-file-name"></b></p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="modal-download-btn">
                    <svg fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:16px; height:16px; vertical-align: middle; margin-right: 8px;"><use href="#icon-download"></use></svg>
                    Download
                </button>
            </div>
        </div>
    </div>
    
    <div id="notification-container"></div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- 1. DATABASE & STATE ---

            // Use JS array instead of localStorage as requested
            const db = {
                questionPapers: [
                    // START MODIFICATION: Added status: 'approved' to all sample data
                    { id: 1, course: 'Btech', branch: 'CSE', semester: 3, subject: 'Data Structures & Algorithms', year: 2024, type: 'End-term', downloads: 245, fileSize: '2.3 MB', fileUrl: 'dummy.pdf', fileObject: null, uploadedBy: 'Sample', status: 'approved' },
                    { id: 2, course: 'Btech', branch: 'CSE', semester: 3, subject: 'Database Management Systems', year: 2023, type: 'Mid-term', downloads: 180, fileSize: '1.1 MB', fileUrl: 'dummy.pdf', fileObject: null, uploadedBy: 'Sample', status: 'approved' },
                    { id: 3, course: 'Btech', branch: 'CSE', semester: 4, subject: 'Operating Systems', year: 2024, type: 'End-term', downloads: 302, fileSize: '1.9 MB', fileUrl: 'dummy.pdf', fileObject: null, uploadedBy: 'Sample', status: 'approved' },
                    { id: 4, course: 'Btech', branch: 'CSE', semester: 4, subject: 'Computer Networks', year: 2023, type: 'Important Questions', downloads: 410, fileSize: '0.8 MB', fileUrl: 'dummy.pdf', fileObject: null, uploadedBy: 'Sample', status: 'approved' },
                    { id: 5, course: 'Btech', branch: 'ECE', semester: 3, subject: 'Digital Electronics', year: 2024, type: 'End-term', downloads: 150, fileSize: '2.1 MB', fileUrl: 'dummy.pdf', fileObject: null, uploadedBy: 'Sample', status: 'approved' },
                    { id: 6, course: 'Btech', branch: 'ECE', semester: 4, subject: 'Analog Communication', year: 2023, type: 'Mid-term', downloads: 98, fileSize: '1.3 MB', fileUrl: 'dummy.pdf', fileObject: null, uploadedBy: 'Sample', status: 'approved' },
                    { id: 7, course: 'Btech', branch: 'ME', semester: 3, subject: 'Thermodynamics', year: 2024, type: 'End-term', downloads: 210, fileSize: '2.5 MB', fileUrl: 'dummy.pdf', fileObject: null, uploadedBy: 'Sample', status: 'approved' },
                    { id: 8, course: 'Btech', branch: 'ME', semester: 4, subject: 'Fluid Mechanics', year: 2023, type: 'End-term', downloads: 176, fileSize: '2.2 MB', fileUrl: 'dummy.pdf', fileObject: null, uploadedBy: 'Sample', status: 'approved' },
                    { id: 9, course: 'Btech', branch: 'CE', semester: 5, subject: 'Structural Analysis', year: 2024, type: 'Mid-term', downloads: 130, fileSize: '1.8 MB', fileUrl: 'dummy.pdf', fileObject: null, uploadedBy: 'Sample', status: 'approved' },
                    { id: 10, course: 'Btech', branch: 'CE', semester: 3, subject: 'Surveying', year: 2023, type: 'Important Questions', downloads: 205, fileSize: '1.0 MB', fileUrl: 'dummy.pdf', fileObject: null, uploadedBy: 'Sample', status: 'approved' },
                    { id: 11, course: 'Btech', branch: 'EE', semester: 4, subject: 'Electrical Machines', year: 2024, type: 'End-term', downloads: 280, fileSize: '2.8 MB', fileUrl: 'dummy.pdf', fileObject: null, uploadedBy: 'Sample', status: 'approved' },
                    { id: 12, course: 'Btech', branch: 'EE', semester: 5, subject: 'Power Systems', year: 2023, type: 'Mid-term', downloads: 190, fileSize: '1.6 MB', fileUrl: 'dummy.pdf', fileObject: null, uploadedBy: 'Sample', status: 'approved' },
                    { id: 13, course: 'Btech', branch: 'IT', semester: 3, subject: 'Object Oriented Programming', year: 2024, type: 'Mid-term', downloads: 165, fileSize: '1.2 MB', fileUrl: 'dummy.pdf', fileObject: null, uploadedBy: 'Sample', status: 'approved' },
                    { id: 14, course: 'Btech', branch: 'IT', semester: 4, subject: 'Web Technologies', year: 2023, type: 'End-term', downloads: 230, fileSize: '1.7 MB', fileUrl: 'dummy.pdf', fileObject: null, uploadedBy: 'Sample', status: 'approved' },
            		{ id: 15, course: 'Btech', branch: 'CSE', semester: 5, subject: 'Theory of Computation', year: 2024, type: 'End-term', downloads: 140, fileSize: '1.4 MB', fileUrl: 'dummy.pdf', fileObject: null, uploadedBy: 'Sample', status: 'approved' },
                    { id: 16, course: 'Btech', branch: 'CSE', semester: 5, subject: 'Compiler Design', year: 2023, type: 'Mid-term', downloads: 115, fileSize: '1.0 MB', fileUrl: 'dummy.pdf', fileObject: null, uploadedBy: 'Sample', status: 'approved' },
                    { id: 17, course: 'Btech', branch: 'ECE', semester: 5, subject: 'VLSI Design', year: 2024, type: 'Important Questions', downloads: 200, fileSize: '0.9 MB', fileUrl: 'dummy.pdf', fileObject: null, uploadedBy: 'Sample', status: 'approved' },
                    { id: 18, course: 'Btech', branch: 'ME', semester: 5, subject: 'Heat Transfer', year: 2023, type: 'End-term', downloads: 155, fileSize: '2.0 MB', fileUrl: 'dummy.pdf', fileObject: null, uploadedBy: 'Sample', status: 'approved' },
                    { id: 19, course: 'Btech', branch: 'CE', semester: 6, subject: 'Geotechnical Engineering', year: 2024, type: 'End-term', downloads: 122, fileSize: '2.1 MB', fileUrl: 'dummy.pdf', fileObject: null, uploadedBy: 'Sample', status: 'approved' },
                    { id: 20, course: 'Btech', branch: 'EE', semester: 6, subject: 'Control Systems', year: 2023, type: 'Mid-term', downloads: 188, fileSize: '1.5 MB', fileUrl: 'dummy.pdf', fileObject: null, uploadedBy: 'Sample', status: 'approved' }
                    // END MODIFICATION
                ],
                currentUser: {
                    name: 'Student',
                    initials: 'S',
                    email: 'student@example.com' // Simulated email
                }
            };

            const appState = {
                currentPage: 'auth',
                currentBranch: null,
                currentSemester: null,
                currentPaper: null,
                filters: {
                    search: '',
                    year: 'all',
                    type: 'all',
                    sort: 'newest'
                },
                uploadedFile: null
            };
            
            // --- 2. DOM SELECTORS ---
            
            // Pages
            const authPage = document.getElementById('auth-page');
            const appPage = document.getElementById('app-page');
            const appSections = document.querySelectorAll('.app-section');
            const appContentArea = document.getElementById('app-content-area');

            // Auth
            const authCardFlipper = document.getElementById('auth-card-flipper');
            const showSignupBtn = document.getElementById('show-signup-btn');
            const showLoginBtn = document.getElementById('show-login-btn');
            const loginForm = document.getElementById('login-form');
            const signupForm = document.getElementById('signup-form');
            const signupPassword = document.getElementById('signup-password');
            const passwordStrengthBars = document.querySelectorAll('.password-strength-bar');
            
            // App Shell
            const logoutBtn = document.getElementById('logout-btn');
            const mobileNavLinks = document.querySelectorAll('.mobile-nav-link');
            const desktopNavLinks = document.querySelectorAll('.desktop-nav .nav-link');
            const profileBtn = document.querySelector('.profile-btn');

            // Dashboard
            const branchCards = document.querySelectorAll('.branch-card');

            // Semesters
            const semesterGrid = document.getElementById('semester-grid');
            const semesterBreadcrumb = document.getElementById('semester-breadcrumb');
            const semesterPageTitle = document.getElementById('semester-page-title');

            // Papers
            const papersBreadcrumb = document.getElementById('papers-breadcrumb');
            const papersPageTitle = document.getElementById('papers-page-title');
            const paperList = document.getElementById('paper-list');
            const emptyState = document.getElementById('empty-state');
            const paperSearch = document.getElementById('paper-search');
            const filterYear = document.getElementById('filter-year');
            const filterType = document.getElementById('filter-type');
            const sortBy = document.getElementById('sort-by');
            
            // Upload
            const uploadForm = document.getElementById('upload-form');
            const dropZone = document.getElementById('drop-zone');
            const fileUploadInput = document.getElementById('file-upload-input');
            const filePreview = document.getElementById('file-preview');
            const fileNameEl = document.getElementById('file-name');
            const fileSizeEl = document.getElementById('file-size');
            const uploadProgress = document.getElementById('upload-progress');
            const fileError = document.getElementById('file-error');
            const uploadInputs = uploadForm.querySelectorAll('input, select');
            
            // Profile
            const profileAvatar = document.getElementById('profile-avatar-initial');
            const profileName = document.getElementById('profile-name');
            const profileEmail = document.getElementById('profile-email');
            const myUploadsList = document.getElementById('my-uploads-list');
            const myUploadsEmptyState = document.getElementById('my-uploads-empty-state');
            
            // Modal
            const modal = document.getElementById('pdf-modal');
            const modalCloseBtn = document.getElementById('modal-close-btn');
            const modalTitle = document.getElementById('modal-title');
            const modalDownloadBtn = document.getElementById('modal-download-btn');
            const modalFileName = document.getElementById('modal-file-name');
            const pdfIframe = document.getElementById('pdf-iframe');
            const pdfSimulation = document.getElementById('pdf-simulation');
            
            // Notifications
            const notificationContainer = document.getElementById('notification-container');


            // --- 3. UTILITY FUNCTIONS ---

            /**
             * Debounce function to limit rapid firing of events
             */
            function debounce(func, delay) {
                let timeout;
                return function(...args) {
                    clearTimeout(timeout);
                    timeout = setTimeout(() => func.apply(this, args), delay);
                };
            }

            /**
             * Navigate between app "pages"
             */
            function navigateTo(pageId) {
                // Handle auth vs app
                if (pageId === 'auth-page') {
                    authPage.style.display = 'flex';
                    appPage.style.display = 'none';
                    appState.currentPage = 'auth';
                    return;
                }
                
                if (appState.currentPage === 'auth') {
                    authPage.style.display = 'none';
                    appPage.style.display = 'block';
                }

                // Handle app pages
                appSections.forEach(section => {
                    section.style.display = 'none';
                });
                
                const targetPage = document.getElementById(pageId);
                if (targetPage) {
                    targetPage.style.display = 'block';
                    appState.currentPage = pageId;
                    
                    // Update nav highlights
                    const navLinks = [...mobileNavLinks, ...desktopNavLinks, profileBtn];
                    navLinks.forEach(link => {
                        link.classList.toggle('active', link.dataset.page === pageId);
                    });
                    
                    // Scroll to top
                    appContentArea.scrollTop = 0;
                }
            }

            /**
             * Show a notification
             */
            function showNotification(message, type = 'success') {
                const notif = document.createElement('div');
                notif.className = `notification ${type}`;
                notif.innerHTML = `<p>${message}</p>`;
                notificationContainer.appendChild(notif);

                setTimeout(() => {
                    notif.classList.add('removing');
                    setTimeout(() => notif.remove(), 500);
                }, 3000);
            }

            /**
             * Show/Clear input error messages
             */
            function showInputError(inputEl, message) {
                const group = inputEl.closest('.input-group');
                if (!group) return;
                const errorEl = group.querySelector('.error-message');
                group.classList.add('error');
                if (errorEl) errorEl.textContent = message;
            }
            
            function clearInputError(inputEl) {
                const group = inputEl.closest('.input-group');
                if (!group) return;
                const errorEl = group.querySelector('.error-message');
                group.classList.remove('error');
                if (errorEl) errorEl.textContent = '';
            }
            
            /**
             * Validate email
             */
            function validateEmail(email) {
                const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return re.test(String(email).toLowerCase());
            }

            /**
             * Create ripple effect on buttons
             */
            function createRipple(event) {
                const button = event.currentTarget;
                const ripple = document.createElement("span");
                const rect = button.getBoundingClientRect();
                const size = Math.max(rect.width, rect.height);
                
                ripple.style.width = ripple.style.height = `${size}px`;
                ripple.style.left = `${event.clientX - rect.left - size / 2}px`;
                ripple.style.top = `${event.clientY - rect.top - size / 2}px`;
                ripple.classList.add("ripple");
                
                button.appendChild(ripple);
                
                ripple.addEventListener('animationend', () => ripple.remove());
            }

            // --- 4. AUTH PAGE LOGIC ---

            /**
             * 3D Card Flip
             */
            showSignupBtn.addEventListener('click', () => authCardFlipper.classList.add('flipped'));
            showLoginBtn.addEventListener('click', () => authCardFlipper.classList.remove('flipped'));

            /**
             * 3D Parallax Hover (Desktop Only)
             * FIX: Added (hover: hover) check to disable on touch devices
             */
            const canHover = window.matchMedia('(hover: hover)').matches;

            if (canHover && window.matchMedia("(min-width: 1024px)").matches) {
                authPage.addEventListener('mousemove', (e) => {
                    const { clientX, clientY } = e;
                    const { innerWidth, innerHeight } = window;
                    
                    const rotateX = ((clientY / innerHeight) - 0.5) * 20; // Max 10deg
                    const rotateY = ((clientX / innerWidth) - 0.5) * -20; // Max 10deg
                    
                    authCardFlipper.style.transform = `rotateY(${authCardFlipper.classList.contains('flipped') ? 180 : 0}deg) rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;
                });

                authPage.addEventListener('mouseleave', () => {
                     authCardFlipper.style.transform = `rotateY(${authCardFlipper.classList.contains('flipped') ? 180 : 0}deg) rotateX(0deg) rotateY(0deg)`;
                });
            }
            
            /**
             * Login Form Validation & Submission
             */
            loginForm.addEventListener('submit', (e) => {
                e.preventDefault();
                let isValid = true;
                const email = loginForm.querySelector('#login-email');
                const password = loginForm.querySelector('#login-password');
                
                // Clear errors
                clearInputError(email);
                clearInputError(password);
                
                if (!validateEmail(email.value)) {
                    showInputError(email, 'Please enter a valid email.');
                    isValid = false;
                }
                if (password.value.length < 8) {
                    showInputError(password, 'Password must be at least 8 characters.');
                    isValid = false;
                }
                
                if (isValid) {
                    // Simulate finding user
                    db.currentUser.email = email.value;
                    db.currentUser.name = email.value.split('@')[0] || 'Student';
                    db.currentUser.initials = db.currentUser.name.charAt(0).toUpperCase();
                    
                    profileBtn.textContent = db.currentUser.initials;
                    profileAvatar.textContent = db.currentUser.initials;
                    profileName.textContent = db.currentUser.name;
                    profileEmail.textContent = db.currentUser.email;

                    showNotification(`Login Successful! Welcome, ${db.currentUser.name}.`, 'success');
                    navigateTo('dashboard-page');
                }
            });

            /**
             * Signup Form Validation & Submission
             */
            signupPassword.addEventListener('input', () => {
                const pass = signupPassword.value;
                let strength = 0;
                if (pass.length >= 8) strength++;
                if (pass.match(/[A-Z]/)) strength++;
                if (pass.match(/[0-9]/) || pass.match(/[^A-Za-z0-9]/)) strength++;
                
                passwordStrengthBars.forEach((bar, i) => {
                    bar.classList.toggle('active', i < strength);
                    bar.classList.remove('weak', 'medium', 'strong');
                    if (i < strength) {
                        if (strength === 1) bar.classList.add('weak');
                        else if (strength === 2) bar.classList.add('medium');
                        else bar.classList.add('strong');
                    }
                });
            });

            signupForm.addEventListener('submit', (e) => {
                e.preventDefault();
                let isValid = true;
                const name = signupForm.querySelector('#signup-name');
                const email = signupForm.querySelector('#signup-email');
                const password = signupForm.querySelector('#signup-password');

                clearInputError(name);
                clearInputError(email);
                clearInputError(password);

                if (name.value.trim() === '') {
                    showInputError(name, 'Name is required.');
                    isValid = false;
                }
                if (!validateEmail(email.value)) {
                    showInputError(email, 'Please enter a valid email.');
                    isValid = false;
                }
                if (password.value.length < 8) {
                    showInputError(password, 'Password must be at least 8 characters.');
                    isValid = false;
                }

                if (isValid) {
                    // Simulate creating user
                    db.currentUser.name = name.value;
                    db.currentUser.email = email.value;
                    db.currentUser.initials = db.currentUser.name.charAt(0).toUpperCase();
                    
                    profileBtn.textContent = db.currentUser.initials;
                    profileAvatar.textContent = db.currentUser.initials;
                    profileName.textContent = db.currentUser.name;
                    profileEmail.textContent = db.currentUser.email;

                    showNotification('Account Created! Welcome to StudyShare.', 'success');
                    navigateTo('dashboard-page');
                }
            });

            /**
             * Logout
             */
            logoutBtn.addEventListener('click', () => {
                loginForm.reset();
                signupForm.reset();
                authCardFlipper.classList.remove('flipped');
                navigateTo('auth-page');
            });


            // --- 5. DASHBOARD PAGE LOGIC ---

            /**
             * 3D Tilt on Branch Cards (Desktop Only)
             * FIX: Added (hover: hover) check to disable on touch devices
             */
            if (canHover && window.matchMedia("(min-width: 1024px)").matches) {
                branchCards.forEach(card => {
                    card.addEventListener('mousemove', (e) => {
                        const rect = card.getBoundingClientRect();
                        const x = e.clientX - rect.left;
                        const y = e.clientY - rect.top;
                        
                        const { width, height } = rect;
                        
                        const rotateX = ((y / height) - 0.5) * -20; // Max 10deg
                        const rotateY = ((x / width) - 0.5) * 20;  // Max 10deg
                        
                        card.style.transform = `perspective(1000px) scale(1.05) rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;
                    });
                    
                    card.addEventListener('mouseleave', () => {
                        card.style.transform = 'perspective(1000px) scale(1) rotateX(0deg) rotateY(0deg)';
                    });
                });
            }

            /**
             * Branch Card Click
             */
            branchCards.forEach(card => {
                card.addEventListener('click', () => {
                    appState.currentBranch = card.dataset.branch;
                    renderSemesterPage();
                    navigateTo('semester-page');
                });
            });


            // --- 6. SEMESTER PAGE LOGIC ---
            
            function renderSemesterPage() {
                const branchName = document.querySelector(`.branch-card[data-branch="${appState.currentBranch}"] h3`).textContent;
                semesterPageTitle.textContent = `Select Semester - ${branchName}`;
                semesterBreadcrumb.innerHTML = `
                    <span class="nav-link" data-page="dashboard-page">Home</span> &gt; ${appState.currentBranch}
                `;
                
                semesterGrid.innerHTML = '';
                
                for (let i = 1; i <= 8; i++) {
                    const paperCount = db.questionPapers.filter(p => 
                        p.branch === appState.currentBranch && 
                        p.semester === i &&
                        p.status === 'approved' // START MODIFICATION: Only count approved papers
                    ).length;
                    
                    const card = document.createElement('div');
                    card.className = 'semester-card stagger-child';
                    card.dataset.semester = i;
                    card.style.animationDelay = `${(i - 1) * 50}ms`;
                    card.innerHTML = `
                        <h3>Semester ${i}</h3>
                        <p>${paperCount} papers available</p>
                    `;
                    card.addEventListener('click', () => {
                        appState.currentSemester = i;
                        renderPapersPage();
                        navigateTo('papers-page');
                    });
                    semesterGrid.appendChild(card);
                }
            }
            
            // Add click listener for semester breadcrumb
            semesterBreadcrumb.addEventListener('click', (e) => {
                if (e.target.classList.contains('nav-link')) {
                    navigateTo(e.target.dataset.page);
                }
            });

            // --- 7. PAPER CARD RENDERING (Helper for Papers & Profile) ---
            
            function createPaperCard(paper, index) {
                const card = document.createElement('article');
                card.className = 'paper-card stagger-child';
                card.style.animationDelay = `${index * 50}ms`;
                
                let typeClass = '';
                if (paper.type === 'End-term') {
                    typeClass = 'badge-end-term';
                } else if (paper.type === 'Mid-term') {
                    typeClass = 'badge-mid-term';
                } else if (paper.type === 'Important Questions') {
                    typeClass = 'badge-important-questions';
                } else if (paper.type === 'PYQ') {
                    typeClass = 'badge-pyq';
                } else if (paper.type === 'Notes') {
                    typeClass = 'badge-notes';
                } else {
                    typeClass = 'badge-mid-term'; // Fallback
                }
                
                // START MODIFICATION: Show status on profile page, or year on papers page
                let cardMetaInfo = '';
                if (appState.currentPage === 'profile-page') {
                    // On profile page, show Branch/Sem and Status
                    const statusClass = paper.status === 'pending' ? 'pending' : 'approved';
                    const statusText = paper.status === 'pending' ? 'Pending Approval' : 'Approved';
                    cardMetaInfo = `
                        <span class="info-item" style="color: var(--color-primary); font-weight: 500;">
                            ${paper.branch} - Sem ${paper.semester}
                        </span>
                        <span class="status-badge ${statusClass}">
                            ${statusText}
                        </span>`;
                } else {
                    // On papers page, show Year and Downloads
                    cardMetaInfo = `
                        <span class="info-item">
                           <svg fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><use href="#icon-calendar"></use></svg>
                           ${paper.year}
                        </span>
                        <span class="info-item">
                            <svg fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><use href="#icon-download"></use></svg>
                            ${paper.downloads}
                        </span>
                    `;
                }
                // END MODIFICATION

                card.innerHTML = `
                    <div class="paper-card-header">
                        <h3 class="subject-name">${paper.subject}</h3>
                        <span class="type-badge ${typeClass}">${paper.type}</span>
                    </div>
                    <div class="paper-card-body">
                        ${cardMetaInfo}
                        <span class="info-item">
                            <svg fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><use href="#icon-file"></use></svg>
                            ${paper.fileSize}
                        </span>
                    </div>
                    <div class="paper-card-footer">
                        <button class="btn btn-sm btn-outline btn-preview">
                            <svg fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:14px; height:14px; vertical-align: middle; margin-right: 4px;"><use href="#icon-eye"></use></svg>
                            Preview
                        </button>
                        <button class="btn btn-sm btn-primary btn-download">
                            <svg fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:14px; height:14px; vertical-align: middle; margin-right: 4px;"><use href="#icon-download"></use></svg>
                            Download
                        </button>
                    </div>
                `;
                
                // Add event listeners
                card.querySelector('.btn-preview').addEventListener('click', (e) => {
                    e.stopPropagation();
                    appState.currentPaper = paper;
                    openPreviewModal(paper);
                });
                
                card.querySelector('.btn-download').addEventListener('click', (e) => {
                    e.stopPropagation();
                    e.currentTarget.addEventListener('click', createRipple);
                    appState.currentPaper = paper;
                    handleDownload(paper);
                });
                
                // START MODIFICATION: Disable buttons for pending items (optional, but good UX)
                if (paper.status === 'pending') {
                    card.querySelector('.btn-download').disabled = true;
                    card.querySelector('.btn-download').style.opacity = 0.6;
                    card.querySelector('.btn-download').style.cursor = 'not-allowed';
                }
                // END MODIFICATION

                return card;
            }


            // --- 8. PAPERS PAGE LOGIC ---

            function renderPapersPage() {
                // Update header & breadcrumb
                papersPageTitle.textContent = `${appState.currentBranch} - Semester ${appState.currentSemester}`;
                papersBreadcrumb.innerHTML = `
                    <span class="nav-link" data-page="dashboard-page">Home</span> &gt; 
                    <span class="nav-link" id="breadcrumb-branch" data-page="semester-page">${appState.currentBranch}</span> &gt; 
                    Semester ${appState.currentSemester}
                `;
                
                // 1. Filter
                let papers = db.questionPapers.filter(p => 
                    p.branch === appState.currentBranch && 
                    p.semester === appState.currentSemester &&
                    p.status === 'approved' // START MODIFICATION: Only show APPROVED papers
                );
                
                if (appState.filters.search) {
                    papers = papers.filter(p => p.subject.toLowerCase().includes(appState.filters.search));
                }
                if (appState.filters.year !== 'all') {
                    papers = papers.filter(p => p.year == appState.filters.year);
                }
                if (appState.filters.type !== 'all') {
                    papers = papers.filter(p => p.type === appState.filters.type);
                }
                
                // 2. Sort
                papers.sort((a, b) => {
                    if (appState.filters.sort === 'downloads') {
                        return b.downloads - a.downloads;
                    }
                    // Default: 'newest' (using ID as proxy for date)
                    return b.id - a.id; 
                });
                
                // 3. Render
                paperList.innerHTML = '';
                if (papers.length === 0) {
                    emptyState.style.display = 'block';
                    paperList.style.display = 'none';
                } else {
                    emptyState.style.display = 'none';
                    paperList.style.display = 'grid';
                    
                    papers.forEach((paper, index) => {
                        const card = createPaperCard(paper, index);
                        paperList.appendChild(card);
                    });
                }
            }

            // Paper filter event listeners
            paperSearch.addEventListener('input', debounce((e) => {
                appState.filters.search = e.target.value.toLowerCase();
                renderPapersPage();
            }, 300));
            
            filterYear.addEventListener('change', (e) => {
                appState.filters.year = e.target.value;
                renderPapersPage();
            });
            
            filterType.addEventListener('change', (e) => {
                appState.filters.type = e.target.value;
                renderPapersPage();
            });
            
            sortBy.addEventListener('change', (e) => {
                appState.filters.sort = e.target.value;
                renderPapersPage();
            });
            
            // Add click listener for papers breadcrumb
            papersBreadcrumb.addEventListener('click', (e) => {
                if (e.target.classList.contains('nav-link')) {
                    const page = e.target.dataset.page;
                    if (page === 'semester-page') {
                        renderSemesterPage();
                    }
                    navigateTo(page);
                }
            });


            // --- 9. PROFILE PAGE LOGIC ---

            function renderProfilePage() {
                // Update user info (in case it changed)
                profileAvatar.textContent = db.currentUser.initials;
                profileName.textContent = db.currentUser.name;
                profileEmail.textContent = `${db.currentUser.email}`;
                
                // START MODIFICATION: Filter papers by user, and sort by ID (newest first)
                const myPapers = db.questionPapers
                    .filter(p => p.uploadedBy === db.currentUser.name)
                    .sort((a, b) => b.id - a.id);
                
                myUploadsList.innerHTML = '';
                if (myPapers.length === 0) {
                    myUploadsEmptyState.style.display = 'block';
                    myUploadsList.style.display = 'none';
                } else {
                    myUploadsEmptyState.style.display = 'none';
                    myUploadsList.style.display = 'grid';
                    
                    myPapers.forEach((paper, index) => {
                        // Pass paper to createPaperCard (which now handles profile-specific rendering)
                        const card = createPaperCard(paper, index); 
                        myUploadsList.appendChild(card);
                    });
                }
                // END MODIFICATION
            }


            // --- 10. DOWNLOAD & PREVIEW LOGIC (UPDATED) ---

            function openPreviewModal(paper) {
                modalTitle.textContent = paper.subject;
                appState.currentPaper = paper; // Set current paper for download btn
                
                // START MODIFICATION: Disable download button in modal if pending
                if (paper.status === 'pending') {
                    modalDownloadBtn.disabled = true;
                    modalDownloadBtn.style.opacity = 0.6;
                    modalDownloadBtn.style.cursor = 'not-allowed';
                } else {
                    modalDownloadBtn.disabled = false;
                    modalDownloadBtn.style.opacity = 1;
                    modalDownloadBtn.style.cursor = 'pointer';
                }
                // END MODIFICATION

                if (paper.fileObject) {
                    // This is a REAL file uploaded by the user
                    pdfIframe.style.display = 'block';
                    pdfSimulation.style.display = 'none';
                    
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        pdfIframe.src = e.target.result;
                    };
                    reader.readAsDataURL(paper.fileObject);
                    
                } else {
                    // This is dummy sample data
                    pdfIframe.style.display = 'none';
                    pdfSimulation.style.display = 'block';
                    modalFileName.textContent = `${paper.subject.replace(/ /g, '_')}_${paper.year}.pdf`;
                }
                
                modal.classList.add('open');
            }
            
            modalCloseBtn.addEventListener('click', () => {
                modal.classList.remove('open');
                pdfIframe.src = 'about:blank'; // Clear iframe src to stop loading
            });
            
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.classList.remove('open');
                    pdfIframe.src = 'about:blank'; // Clear iframe src
                }
            });
            
            modalDownloadBtn.addEventListener('click', () => {
                handleDownload(appState.currentPaper);
            });
            
            function handleDownload(paper) {
                // START MODIFICATION: Do not allow download if pending
                if (paper.status === 'pending') {
                    showNotification('This file is pending approval and cannot be downloaded.', 'error');
                    return;
                }
                // END MODIFICATION
                
                let url, fileName;
                
                if (paper.fileObject) {
                    // REAL file download
                    url = URL.createObjectURL(paper.fileObject);
                    fileName = paper.fileObject.name;
                } else {
                    // SIMULATED file download
                    const fakePdfContent = `This is a simulated PDF for ${paper.subject} (${paper.year}).`;
                    const blob = new Blob([fakePdfContent], { type: 'application/pdf' });
                    url = URL.createObjectURL(blob);
                    fileName = `${paper.subject.replace(/ /g, '_')}_${paper.year}.pdf`;
                }
                
                const a = document.createElement('a');
                a.href = url;
                a.download = fileName;
                document.body.appendChild(a);
                a.click();
                
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                // Update download count (only for sample data, real uploads are not shared yet)
                if (!paper.fileObject) {
                    paper.downloads++;
                }
                
                showNotification('Download started!', 'success');
                // Re-render if on papers page to show new count
                if(appState.currentPage === 'papers-page') {
                    renderPapersPage();
                } else if (appState.currentPage === 'profile-page') {
                    renderProfilePage();
                }
            }


            // --- 11. UPLOAD PAGE LOGIC (UPDATED) ---

            // Drag and Drop
            dropZone.addEventListener('click', () => fileUploadInput.click());
            
            dropZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                dropZone.classList.add('dragging');
            });
            
            dropZone.addEventListener('dragleave', () => {
                dropZone.classList.remove('dragging');
            });
            
            dropZone.addEventListener('drop', (e) => {
                e.preventDefault();
                dropZone.classList.remove('dragging');
                const file = e.dataTransfer.files[0];
                handleFileUpload(file);
            });
            
            fileUploadInput.addEventListener('change', (e) => {
                const file = e.target.files[0];
                handleFileUpload(file);
            });

            function handleFileUpload(file) {
                fileError.style.display = 'none';
                appState.uploadedFile = null;

                if (!file) return;

                // Validate Type
                if (file.type !== 'application/pdf') {
                    fileError.textContent = 'Invalid file type. Please upload a PDF.';
                    fileError.style.display = 'block';
                    return;
                }
                
                // Validate Size
                const maxSize = 10 * 1024 * 1024; // 10MB
                if (file.size > maxSize) {
                    fileError.textContent = 'File is too large. Max size is 10MB.';
                    fileError.style.display = 'block';
                    return;
                }
                
                // Show preview
                appState.uploadedFile = file; // <-- Store the ACTUAL File object
                fileNameEl.textContent = file.name;
                fileSizeEl.textContent = (file.size / 1024 / 1024).toFixed(2) + ' MB';
                filePreview.style.display = 'block';
                
                // Simulate progress
                uploadProgress.style.width = '0%';
                setTimeout(() => {
                    uploadProgress.style.width = '100%';
                }, 100);
            }
            
            // Form Submission
            uploadForm.addEventListener('submit', (e) => {
                e.preventDefault();
                let isValid = true;
                
                // Clear all errors
                uploadInputs.forEach(clearInputError);
                fileError.style.display = 'none';
                
                // Validate form fields
                uploadInputs.forEach(input => {
                    if (input.required && !input.value) {
                        showInputError(input, 'This field is required.');
                        isValid = false;
                    }
                });
                
                // Validate file
                if (!appState.uploadedFile) {
                    fileError.textContent = 'Please upload a PDF file.';
                    fileError.style.display = 'block';
                    isValid = false;
                }
                
                if (isValid) {
                    // Create new paper object
                    const newPaper = {
                        id: db.questionPapers.length + 1,
                        course: uploadForm.querySelector('#upload-course').value,
                        branch: uploadForm.querySelector('#upload-branch').value,
                        semester: parseInt(uploadForm.querySelector('#upload-semester').value),
                        subject: uploadForm.querySelector('#upload-subject').value,
                        year: parseInt(uploadForm.querySelector('#upload-year').value),
                        type: uploadForm.querySelector('#upload-type').value,
                        downloads: 0,
                        fileSize: (appState.uploadedFile.size / 1024 / 1024).toFixed(2) + ' MB',
                        fileUrl: null, // No dummy URL
                        fileObject: appState.uploadedFile, // Store the real file object
                        uploadedBy: db.currentUser.name, // Link to current user
                        status: 'pending' // START MODIFICATION: Set new uploads to 'pending'
                    };
                    
                    // Add to DB (at the beginning)
                    db.questionPapers.unshift(newPaper);
                    
                    // Reset form
                    uploadForm.reset();
                    filePreview.style.display = 'none';
                    uploadProgress.style.width = '0%';
                    appState.uploadedFile = null;
                    
                    // Notify and navigate
                    showNotification('Upload successful! Your file is pending approval.', 'success');
                    
                    // START MODIFICATION: Navigate to profile page to show pending upload
                    renderProfilePage();
                    navigateTo('profile-page');
                    // END MODIFICATION
                }
            });


            // --- 12. APP NAVIGATION (MOBILE & DESKTOP) ---

            function handleNavClick(e) {
                const pageId = e.currentTarget.dataset.page;
                                
                if (pageId === 'semester-page' && appState.currentBranch) {
                    renderSemesterPage();
                }
                
                if (pageId === 'profile-page') {
                    renderProfilePage();
                }
                
                if (pageId) {
                    navigateTo(pageId);
                }
            }

            mobileNavLinks.forEach(link => link.addEventListener('click', handleNavClick));
            desktopNavLinks.forEach(link => link.addEventListener('click', handleNavClick));
            profileBtn.addEventListener('click', handleNavClick); // <-- Add listener to header profile btn

            // Add ripple to all primary buttons
            document.querySelectorAll('.btn-primary').forEach(btn => {
                btn.addEventListener('click', createRipple);
            });
            
            // --- 13. INITIALIZATION ---
            
            // Set initial user info
            profileBtn.textContent = db.currentUser.initials;
            profileAvatar.textContent = db.currentUser.initials;
            profileName.textContent = db.currentUser.name;
            profileEmail.textContent = `${db.currentUser.email}`;
        });
    </script>
</body>
</html>